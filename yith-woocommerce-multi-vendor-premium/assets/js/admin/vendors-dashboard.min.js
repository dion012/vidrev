(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=l(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},u.apply(this,arguments)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function d(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.r(t);const h={xhr:!1,block:function(e){e&&e.length&&void 0!==jQuery.fn.block&&(e.addClass("ajax-blocked"),e.block({message:null,overlayCSS:{background:"#fff no-repeat center",opacity:.5,cursor:"none"}}))},unblock:function(e){e&&e.hasClass("ajax-blocked")&&void 0!==jQuery.fn.block&&(e.unblock(),e.removeClass("ajax-blocked"))},call:function(e,t,r){var n=this;return r=void 0!==r?r:"GET",Array.isArray(e)?(e.push({name:"action",value:yith_wcmv_ajax.ajaxAction}),e.push({name:"security",value:yith_wcmv_ajax.ajaxNonce}),e.push({name:"context",value:"admin"})):(e.action=yith_wcmv_ajax.ajaxAction,e.security=yith_wcmv_ajax.ajaxNonce,e.context="admin"),n.block(t),n.xhr=jQuery.ajax({url:yith_wcmv_ajax.ajaxUrl,data:e,type:r}).fail((function(e){console.log(e),n.unblock(t)})).done((function(e){n.unblock(t),n.xhr=!1})),n.xhr},get:function(e,t){return this.call(e,t,"GET")},post:function(e,t){return this.call(e,t,"POST")},abort:function(){this.xhr&&this.xhr.abort()}};function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=a(e);if(t){var i=a(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d(this,r)}}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(n,e);var t=v(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return f(o(e=t.call.apply(t,[this].concat(a))),"states",null),e}return i(n,[{key:"init",value:function(){"undefined"!=typeof yith_wcmv_vendors&&(this.states=JSON.parse(yith_wcmv_vendors.countries.replace(/&quot;/g,'"'))),this.container.find(".vendor-image-upload-input").each(this.initImageValue.bind(this)),this.container.on("change",".country-field",{self:this},this.changeCountry),jQuery(".country-field").change(),this.container.on("click",".upload_vendor_image_button",{self:this},this.uploadImage),this.container.on("click",".remove_vendor_image_button",{self:this},this.removeImage),u(a(n.prototype),"init",this).call(this),this.container.on("keyup",".ajax-check",{self:this},this.validateField),this.initSlugField()}},{key:"addImage",value:function(e,t,r){e.find('input[type="hidden"]').val(t),e.css("background-image","url("+r+")"),e.find(".upload_vendor_image_button").hide(),e.find(".remove_vendor_image_button").show()}},{key:"removeImage",value:function(e){e.preventDefault();var t=jQuery(this).closest(".vendor-image-upload");return t.find('input[type="hidden"]').val(""),t.css("background-image",""),t.find(".upload_vendor_image_button").show(),jQuery(this).hide(),!1}},{key:"changeCountry",value:function(e){var t=e.data.self;if(null!==t.states){var r,n=jQuery(this),i=n.val(),o=n.closest("form").find(".state-field"),a=o.parent(),l=o.val(),u=o.attr("name"),c=o.attr("id"),s=o.attr("placeholder");if(a.show().find(".select2-container").remove(),jQuery.isEmptyObject(t.states[i]))r=jQuery('<input type="text" />').prop("id",c).prop("name",u).prop("placeholder",s).addClass("state-field").val(l),o.replaceWith(r);else{var d=t.states[i],f=jQuery('<option value=""></option>').text(yith_wcmv_vendors.i18nSelectStateText);r=jQuery("<select></select>").prop("id",c).prop("name",u).prop("placeholder",s).addClass("state-field").append(f),jQuery.each(d,(function(e){var t=jQuery("<option></option>").prop("value",e).text(d[e]);e===l&&t.prop("selected"),r.append(t)})),r.val(l),o.replaceWith(r),r.show().selectWoo().hide().trigger("change")}}}},{key:"uploadImage",value:function(e){e.preventDefault();var t=e.data.self,r=jQuery(this).closest(".vendor-image-upload"),n=wp.media.frames.downloadable_file=wp.media({title:yith_wcmv_vendors.uploadFrameTitle,button:{text:yith_wcmv_vendors.uploadFrameButtonText},multiple:!1});n.on("select",(function(){var e=n.state().get("selection").first().toJSON();t.addImage(r,e.id,e.sizes.full.url)})),n.open()}},{key:"initImageValue",value:function(e,t){var r,n=jQuery(t),i=null!==(r=n.data("value"))&&void 0!==r?r:null;if(null!==i){for(var o in i)this.addImage(n.parent(),o,i[o]);n.removeAttr("data-value")}}},{key:"initSlugField",value:function(){var e=this.container.find("input#slug"),t=e.closest(".vendor-field").find(".description");t.data("text",t.text()),e.on("keyup",(function(){var e=jQuery(this).val();e?(e=e.toLowerCase().replace(/[^0-9a-z-]+/,"-"),t.text(t.data("text").replace("%yith_shop_vendor%",e)),jQuery(this).val(e)):t.text("")})).keyup()}},{key:"validateField",value:function(e){var t=e.data.self;h.abort();var r=jQuery(this),n=r.val();if(r.removeClass("error success"),!n.length)return!1;r.addClass("loading"),h.get({request:r.data("action"),value:n,vendor_id:t.container.find('input[name="vendor_id"]').val()}).fail((function(){r.removeClass("loading")})).done((function(e){r.removeClass("loading"),e.success?(r.addClass("success"),t.resetFieldError(r.attr("name"))):(r.addClass("error"),t.addFieldError(e.data.error,r.attr("name")))}))}}]),n}(function(){function e(t){r(this,e),f(this,"container",null),this.container=t}return i(e,[{key:"init",value:function(){if(!this.container.length)return!1;jQuery(document).trigger("yith_fields_init"),jQuery(document.body).trigger("yith-plugin-fw-init-radio"),jQuery(document).trigger("yith-add-box-button-toggle"),this.initValue(),this.initEnhancedSelect(),this.initTinyMCE(),this.container.on("change",".field-required",{self:this},this.listenRequired),this.container.on("change",".email-validate",{self:this},this.validateEmail),this.container.closest("form").on("submit",this.checkFormErrors.bind(this))}},{key:"initTinyMCE",value:function(){"undefined"!=typeof tinyMCE&&"undefined"!=typeof tinyMCEPreInit&&this.container.find(".editor textarea").each((function(){var e=jQuery(this).attr("id"),t=tinyMCEPreInit.mceInit,r=Object.keys(t)[0],n=t[r],i=tinyMCEPreInit.qtInit,o=t[Object.keys(i)[0]];n.selector=e,n.body_class=n.body_class.replace(r,e),o.id=e,tinyMCE.init(n),tinyMCE.execCommand("mceRemoveEditor",!0,e),tinyMCE.execCommand("mceAddEditor",!0,e),quicktags(o),QTags._buttonsInit()}))}},{key:"initValue",value:function(){this.container.find(":input").each((function(){var e,t=jQuery(this),r=null!==(e=t.data("value"))&&void 0!==e?e:null;if(!t.is(":radio")&&"hidden"!==t.attr("type")&&null!==r)if(t.is(":checkbox")){var n=t.is(":checked");(!n&&"yes"===r||n&&"yes"!==r)&&t.click()}else t.val(r)}))}},{key:"initEnhancedSelect",value:function(){if("undefined"==typeof yith_wcmv_ajax||void 0===jQuery.fn.selectWoo)return!1;this.container.find("select.yith-wcmv-ajax-search").filter(":not(.initialized)").each((function(){var e,t=jQuery(this),r=null!==(e=t.data("value"))&&void 0!==e?e:null;if(null!==r)for(var n in r)t.append(new Option(r[n],n,!0,!0));t.trigger("change"),t.selectWoo({allowClear:!0,placeholder:jQuery(this).data("placeholder"),minimumInputLength:"3",escapeMarkup:function(e){return e},ajax:{url:yith_wcmv_ajax.ajaxUrl,dataType:"json",delay:1e3,data:function(e){return{term:e.term,request:jQuery(this).data("action"),action:yith_wcmv_ajax.ajaxAction,security:yith_wcmv_ajax.ajaxNonce,context:"admin"}},processResults:function(e){var t=[];return e.success&&jQuery.each(e.data,(function(e,r){t.push({id:e,text:r})})),{results:t}},cache:!0}}).addClass("initialized").on("select2:select",(function(e){t.find("option.value-placeholder").remove()})).on("select2:unselect",(function(e){var r=e.params.data.id;t.find('option[value="'+r+'"]').remove(),t.find("option").length||t.append('<option value="" class="value-placeholder"></option>')}))})),this.container.find("select").filter(":not(.initialized)").each((function(){var e,t=jQuery(this),r=null!==(e=t.data("value"))&&void 0!==e?e:null,n=jQuery(this).find("option").filter('[value=""]'),i={minimumResultsForSearch:20};n.length&&(i.placeholder={id:"",text:n.text()},i.allowClear=!0),null!==r&&t.val(r).change(),t.selectWoo(i).addClass("initialized")}))}},{key:"isValidEmail",value:function(e){return e.toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},{key:"validateEmail",value:function(e){var t,r=e.data.self,n=jQuery(this),i=n.val();i&&!r.isValidEmail(i)?r.addFieldError(null===(t=yith_vendors)||void 0===t?void 0:t.emailFieldError,n.attr("name")):r.resetFieldError(n.attr("name"))}},{key:"addFormError",value:function(e,t){t.prepend('<div id="error-message">'+e+"</div>")}},{key:"addFieldError",value:function(e,t,r){r&&r.length||(r=this.container);var n=r.find('[name="'+t+'"]');n.length||this.addFormError(e,r);var i=n.next(".error-msg");n.addClass("field-error"),i.length?i.html(e):n.after('<span class="error-msg">'+e+"</span>")}},{key:"resetFormError",value:function(e){var t=this;e&&e.length||(e=this.container),e.find("#error-message").remove(),e.find(".field-error").each((function(e,r){t.resetFieldError(jQuery(r).attr("name"))}))}},{key:"resetFieldError",value:function(e){if(e&&this.container.find('[name="'+e+'"]')){var t=this.container.find('[name="'+e+'"]');t.removeClass("field-error"),t.next(".error-msg").remove()}}},{key:"listenRequired",value:function(e){var t,r=e.data.self,n=jQuery(this),i=n.attr("name");n.val()?n.hasClass("ajax-check")||r.resetFieldError(i):r.addFieldError(null===(t=yith_vendors)||void 0===t?void 0:t.requiredFieldError,i)}},{key:"isFormWithErrors",value:function(){var e=this.container.closest("form");return e.find(":input").filter(".field-required").trigger("change"),!!e.find("#error-message, .field-error").length}},{key:"checkFormErrors",value:function(e){this.isFormWithErrors()&&(e.preventDefault(),jQuery("html").animate({scrollTop:this.container.find("#error-message, .field-error").first().offset().top-100},1e3))}}]),e}()),p=jQuery(".vendor-fields-container");p.length&&new y(p).init();if(jQuery(document.body).hasClass("post-type-product")&&(jQuery(".woocommerce-BlankState").find(".woocommerce-BlankState-cta.button").not(".button-primary").remove(),yith_wcmv_vendors.hideFeaturedProduct&&jQuery("#_featured").add('[for="_featured"]').remove()),jQuery(document.body).hasClass("post-type-shop_order")){var m,g,j;if(jQuery(".wc-order-edit-line-item").remove(),jQuery(".wc-order-edit-line-item-actions").remove(),jQuery("a.delete-order-tax").remove(),"no"===(null===(m=yith_wcmv_vendors.orderDataToShow)||void 0===m?void 0:m.customer)){var _=jQuery("#order_data").find(".wc-customer-user");_.replaceWith('<input type="hidden" name="customer_user" value="'+_.find("select").val()+'"/>'),jQuery(".wc-customer-search").remove()}"no"===(null===(g=yith_wcmv_vendors.orderDataToShow)||void 0===g?void 0:g.payment)&&jQuery("#order_data").find(".order_number").remove(),"no"===(null===(j=yith_wcmv_vendors.orderDataToShow)||void 0===j?void 0:j.address)&&jQuery("#order_data .order_data_column:nth-child(2)").add("#order_data .order_data_column:nth-child(3)").remove()}var b=window;for(var w in t)b[w]=t[w];t.__esModule&&Object.defineProperty(b,"__esModule",{value:!0})})();