(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}e.r(n);const r={xhr:!1,block:function(e){e&&e.length&&void 0!==jQuery.fn.block&&(e.addClass("ajax-blocked"),e.block({message:null,overlayCSS:{background:"#fff no-repeat center",opacity:.5,cursor:"none"}}))},unblock:function(e){e&&e.hasClass("ajax-blocked")&&void 0!==jQuery.fn.block&&(e.unblock(),e.removeClass("ajax-blocked"))},call:function(e,n,t){var a=this;return t=void 0!==t?t:"GET",Array.isArray(e)?(e.push({name:"action",value:yith_wcmv_ajax.ajaxAction}),e.push({name:"security",value:yith_wcmv_ajax.ajaxNonce}),e.push({name:"context",value:"admin"})):(e.action=yith_wcmv_ajax.ajaxAction,e.security=yith_wcmv_ajax.ajaxNonce,e.context="admin"),a.block(n),a.xhr=jQuery.ajax({url:yith_wcmv_ajax.ajaxUrl,data:e,type:t}).fail((function(e){console.log(e),a.unblock(n)})).done((function(e){a.unblock(n),a.xhr=!1})),a.xhr},get:function(e,n){return this.call(e,n,"GET")},post:function(e,n){return this.call(e,n,"POST")},abort:function(){this.xhr&&this.xhr.abort()}};var o=function(){function e(n){var a,i,r;t(this,e),r=null,(i="container")in(a=this)?Object.defineProperty(a,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[i]=r,this.container=n}return i(e,[{key:"init",value:function(){if(!this.container.length)return!1;jQuery(document).trigger("yith_fields_init"),jQuery(document.body).trigger("yith-plugin-fw-init-radio"),jQuery(document).trigger("yith-add-box-button-toggle"),this.initValue(),this.initEnhancedSelect(),this.initTinyMCE(),this.container.on("change",".field-required",{self:this},this.listenRequired),this.container.on("change",".email-validate",{self:this},this.validateEmail),this.container.closest("form").on("submit",this.checkFormErrors.bind(this))}},{key:"initTinyMCE",value:function(){"undefined"!=typeof tinyMCE&&"undefined"!=typeof tinyMCEPreInit&&this.container.find(".editor textarea").each((function(){var e=jQuery(this).attr("id"),n=tinyMCEPreInit.mceInit,t=Object.keys(n)[0],a=n[t],i=tinyMCEPreInit.qtInit,r=n[Object.keys(i)[0]];a.selector=e,a.body_class=a.body_class.replace(t,e),r.id=e,tinyMCE.init(a),tinyMCE.execCommand("mceRemoveEditor",!0,e),tinyMCE.execCommand("mceAddEditor",!0,e),quicktags(r),QTags._buttonsInit()}))}},{key:"initValue",value:function(){this.container.find(":input").each((function(){var e,n=jQuery(this),t=null!==(e=n.data("value"))&&void 0!==e?e:null;if(!n.is(":radio")&&"hidden"!==n.attr("type")&&null!==t)if(n.is(":checkbox")){var a=n.is(":checked");(!a&&"yes"===t||a&&"yes"!==t)&&n.click()}else n.val(t)}))}},{key:"initEnhancedSelect",value:function(){if("undefined"==typeof yith_wcmv_ajax||void 0===jQuery.fn.selectWoo)return!1;this.container.find("select.yith-wcmv-ajax-search").filter(":not(.initialized)").each((function(){var e,n=jQuery(this),t=null!==(e=n.data("value"))&&void 0!==e?e:null;if(null!==t)for(var a in t)n.append(new Option(t[a],a,!0,!0));n.trigger("change"),n.selectWoo({allowClear:!0,placeholder:jQuery(this).data("placeholder"),minimumInputLength:"3",escapeMarkup:function(e){return e},ajax:{url:yith_wcmv_ajax.ajaxUrl,dataType:"json",delay:1e3,data:function(e){return{term:e.term,request:jQuery(this).data("action"),action:yith_wcmv_ajax.ajaxAction,security:yith_wcmv_ajax.ajaxNonce,context:"admin"}},processResults:function(e){var n=[];return e.success&&jQuery.each(e.data,(function(e,t){n.push({id:e,text:t})})),{results:n}},cache:!0}}).addClass("initialized").on("select2:select",(function(e){n.find("option.value-placeholder").remove()})).on("select2:unselect",(function(e){var t=e.params.data.id;n.find('option[value="'+t+'"]').remove(),n.find("option").length||n.append('<option value="" class="value-placeholder"></option>')}))})),this.container.find("select").filter(":not(.initialized)").each((function(){var e,n=jQuery(this),t=null!==(e=n.data("value"))&&void 0!==e?e:null,a=jQuery(this).find("option").filter('[value=""]'),i={minimumResultsForSearch:20};a.length&&(i.placeholder={id:"",text:a.text()},i.allowClear=!0),null!==t&&n.val(t).change(),n.selectWoo(i).addClass("initialized")}))}},{key:"isValidEmail",value:function(e){return e.toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},{key:"validateEmail",value:function(e){var n,t=e.data.self,a=jQuery(this),i=a.val();i&&!t.isValidEmail(i)?t.addFieldError(null===(n=yith_vendors)||void 0===n?void 0:n.emailFieldError,a.attr("name")):t.resetFieldError(a.attr("name"))}},{key:"addFormError",value:function(e,n){n.prepend('<div id="error-message">'+e+"</div>")}},{key:"addFieldError",value:function(e,n,t){t&&t.length||(t=this.container);var a=t.find('[name="'+n+'"]');a.length||this.addFormError(e,t);var i=a.next(".error-msg");a.addClass("field-error"),i.length?i.html(e):a.after('<span class="error-msg">'+e+"</span>")}},{key:"resetFormError",value:function(e){var n=this;e&&e.length||(e=this.container),e.find("#error-message").remove(),e.find(".field-error").each((function(e,t){n.resetFieldError(jQuery(t).attr("name"))}))}},{key:"resetFieldError",value:function(e){if(e&&this.container.find('[name="'+e+'"]')){var n=this.container.find('[name="'+e+'"]');n.removeClass("field-error"),n.next(".error-msg").remove()}}},{key:"listenRequired",value:function(e){var n,t=e.data.self,a=jQuery(this),i=a.attr("name");a.val()?a.hasClass("ajax-check")||t.resetFieldError(i):t.addFieldError(null===(n=yith_vendors)||void 0===n?void 0:n.requiredFieldError,i)}},{key:"isFormWithErrors",value:function(){var e=this.container.closest("form");return e.find(":input").filter(".field-required").trigger("change"),!!e.find("#error-message, .field-error").length}},{key:"checkFormErrors",value:function(e){this.isFormWithErrors()&&(e.preventDefault(),jQuery("html").animate({scrollTop:this.container.find("#error-message, .field-error").first().offset().top-100},1e3))}}]),e}();if("undefined"!=typeof yith_wcmv_announcements)new(function(){function e(){t(this,e),this.init()}return i(e,[{key:"init",value:function(){jQuery(document).on("click","a.page-title-action",{announcement:this},this.create),jQuery(document).on("click","button.save-announcement-modal",this.save),jQuery(document).on("click",".yith-plugin-fw__action-button--edit-action, a.row-title",{announcement:this},this.edit),jQuery(document).on("change",'input[name="_announcement_enabled"]',this.active)}},{key:"openModal",value:function(e){var n=wp.template("yith-wcmv-modal-announcement"),t=wp.template("yith-wcmv-modal-announcement-buttons");yith.ui.modal({width:700,closeSelector:".close-announcement-modal",classes:{wrap:"announcement-modal",content:"yith-plugin-ui"},title:yith_wcmv_announcements.modalTitle,content:n(e),footer:t({}),onCreate:function(){new o(jQuery("form.announcement-modal-form")).init()}})}},{key:"create",value:function(e){e.preventDefault(),e.data.announcement.openModal(yith_wcmv_announcements.defaultModalValues)}},{key:"edit",value:function(e){e.preventDefault();var n=e.data.announcement,t=jQuery(this).closest("tr"),a=t.find('[name="post[]"]').val();if(!a)return!1;r.abort(),t.data("announcement-data")?n.openModal(t.data("announcement-data")):r.call({request:"get_announcement_data",announcement_id:a},jQuery(this).closest("td")).done((function(e){e.success&&(t.data("announcement-data",e.data),n.openModal(e.data))}))}},{key:"active",value:function(e){e.preventDefault();var n=jQuery(this).is(":checked")?"yes":"no",t=jQuery(this).closest("tr").find('[name="post[]"]').val();r.call({request:"announcement_active_switch",announcement_id:t,active:n},jQuery(this).closest("td"),"POST")}},{key:"save",value:function(e){e.preventDefault(),jQuery(".announcement-modal-form").submit()}}]),e}());var l=window;for(var c in n)l[c]=n[c];n.__esModule&&Object.defineProperty(l,"__esModule",{value:!0})})();